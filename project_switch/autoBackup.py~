#!/usr/bin/python3
import switch

def getInfo(**args):
    SW = switch.switch(**args)
    infoList = ['config', 'cpu', 'memory']
    args.update(SW.getInfo(infoList))
    args['name'] = SW.name
    return args

# main
global outPut
Path = '/home/meidl/python/project_switch/switches.txt'
Switches = switch.getSW(Path)
# 将要执行的函数和参数分别组合成字典存入数组 tasks
tasks = [{'func':getInfo, 'args':each} for each in Switches]

# threadRunner 以多线程方式执行传入的数组里的函数以及对应的参数
thread_runner = switch.threadRunner(tasks)
thread_runner.run()

#以数组形式返回函数的执行返回值
result = thread_runner.getRes()

for each in result:
    if not each.get('error', None):
        print('%s:%s(name), %s(config), %s(cpu), %s(memory)' % (each['ip'], each['name'], len(each['config']),len(each['cpu']),len(each['memory'])))
    else:
        print('%s:%s' % (each['ip'], each['error']))

